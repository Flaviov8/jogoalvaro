<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jogo Espacial Moderno</title>

<style>
    html, body {
        margin: 0;
        overflow: hidden;
        background: black;
        height: 100%;
    }

    canvas {
        background: url('https://i.imgur.com/0ZfQx94.jpeg');
        background-size: cover;
        display: block;
    }

    /* ----------- D-PAD CIRCULAR ----------- */
    #dpad {
        position: fixed;
        bottom: 20px;
        left: 20px;
        width: 160px;
        height: 160px;
        border-radius: 50%;
        background: rgba(255,255,255,0.1);
        backdrop-filter: blur(6px);
        border: 2px solid rgba(255,255,255,0.2);
        z-index: 9999;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .btn-dir {
        position: absolute;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: rgba(255,255,255,0.15);
        border: 2px solid rgba(255,255,255,0.3);
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
        font-size: 28px;
        user-select: none;
        touch-action: none;
    }

    #btnUp { top: 5px; }
    #btnDown { bottom: 5px; }
    #btnLeft { left: 5px; }
    #btnRight { right: 5px; }

    /* ----------- BOTÃƒO DE TIRO ----------- */
    #shootButton {
        position: fixed;
        right: 22px;
        bottom: 22px;
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background: rgba(255,255,255,0.18);
        backdrop-filter: blur(8px);
        border: 2px solid rgba(255,255,255,0.35);
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
        font-size: 34px;
        z-index: 9999;
        user-select: none;
        touch-action: none;
    }

    #shootButton:active { transform: scale(0.88); }

    /* ----------- HUD ----------- */
    #hud {
        position: fixed;
        top: 10px;
        left: 10px;
        color: white;
        font-family: Arial;
        font-size: 20px;
        z-index: 9999;
        text-shadow: 0 0 5px black;
    }
</style>
</head>

<body>
<canvas id="gameCanvas"></canvas>

<!-- HUD -->
<div id="hud">Vidas: <span id="vidasTxt">10</span> | Inimigos destruÃ­dos: <span id="scoreTxt">0</span></div>

<!-- D-PAD -->
<div id="dpad">
    <div class="btn-dir" id="btnUp">â–²</div>
    <div class="btn-dir" id="btnDown">â–¼</div>
    <div class="btn-dir" id="btnLeft">â—€</div>
    <div class="btn-dir" id="btnRight">â–¶</div>
</div>

<!-- BOTÃƒO DE TIRO -->
<button id="shootButton">ðŸ”¥</button>

<script>
/* ============================
   CONFIGURAÃ‡Ã•ES INICIAIS
============================ */
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let vidas = 10;
let score = 0;

document.getElementById("vidasTxt").innerText = vidas;
document.getElementById("scoreTxt").innerText = score;

/* ============================
   IMAGENS
============================ */
const playerImg = new Image();
playerImg.src = "alvaro2.png";

const enemyImg = new Image();
enemyImg.src = "flavioinimigo.png";

/* ============================
   NAVE DO JOGADOR
============================ */
let player = {
    x: canvas.width / 2 - 40,
    y: canvas.height - 160,
    width: 80,
    height: 80,
    speed: 7,
    alive: true
};

/* ============================
   CONTROLE POR TECLADO
============================ */
let keys = {};

document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

/* ============================
   CONTROLE TOUCH â€“ D-PAD
============================ */
const touchState = { up:false, down:false, left:false, right:false };

function bindTouch(id, prop) {
    const btn = document.getElementById(id);
    btn.addEventListener("touchstart", e => { e.preventDefault(); touchState[prop] = true; });
    btn.addEventListener("touchend",   e => { e.preventDefault(); touchState[prop] = false; });
}

bindTouch("btnUp","up");
bindTouch("btnDown","down");
bindTouch("btnLeft","left");
bindTouch("btnRight","right");

/* ============================
   BOTÃƒO DE TIRO TOUCH
============================ */
let shooting = false;

document.getElementById("shootButton").addEventListener("touchstart", e => {
    e.preventDefault();
    shooting = true;
    shoot();
});

document.getElementById("shootButton").addEventListener("touchend", e => {
    e.preventDefault();
    shooting = false;
});

document.getElementById("shootButton").onclick = () => shoot();

/* ============================
   TIROS
============================ */
let bullets = [];

function shoot() {
    bullets.push({
        x: player.x + player.width / 2 - 4,
        y: player.y,
        width: 8,
        height: 15,
        speed: 10
    });
}

/* ============================
   INIMIGOS
============================ */
let enemies = [];

function spawnEnemy() {
    enemies.push({
        x: Math.random() * (canvas.width - 60),
        y: -80,
        width: 70,
        height: 70,
        speed: 2 + Math.random() * 3,
        alive: true
    });
}
setInterval(spawnEnemy, 900);

/* ============================
   EXPLOSÃƒO
============================ */
function explode(x, y) {
    for (let i = 0; i < 25; i++) {
        particles.push({
            x, y,
            dx: (Math.random()-0.5)*6,
            dy: (Math.random()-0.5)*6,
            life: 30
        });
    }
}

/* ============================
   PARTÃCULAS
============================ */
let particles = [];

/* ============================
   LOOP DO JOGO
============================ */
function update() {

    if (!player.alive) return;

    /* MOVIMENTO â€“ TECLADO + TOUCH */
    if (keys["ArrowLeft"]   || touchState.left)  player.x -= player.speed;
    if (keys["ArrowRight"]  || touchState.right) player.x += player.speed;
    if (keys["ArrowUp"]     || touchState.up)    player.y -= player.speed;
    if (keys["ArrowDown"]   || touchState.down)  player.y += player.speed;

    /* LIMITES */
    player.x = Math.max(0, Math.min(canvas.width - player.width, player.x));
    player.y = Math.max(0, Math.min(canvas.height - player.height, player.y));

    /* ATUALIZA TIROS */
    bullets.forEach(b => b.y -= b.speed);
    bullets = bullets.filter(b => b.y > -50);

    /* ATUALIZA INIMIGOS */
    enemies.forEach(e => e.y += e.speed);

    /* COLISÃ•ES */
    enemies.forEach(e => {
        bullets.forEach(b => {
            if (b.x < e.x + e.width &&
                b.x + b.width > e.x &&
                b.y < e.y + e.height &&
                b.y + b.height > e.y
            ) {
                explode(e.x+e.width/2, e.y+e.height/2);
                e.alive = false;
                score++;
                document.getElementById("scoreTxt").innerText = score;
            }
        });

        // inimigo bate na nave
        if (e.x < player.x + player.width &&
            e.x + e.width > player.x &&
            e.y < player.y + player.height &&
            e.y + e.height > player.y
        ) {
            explode(player.x+40, player.y+40);
            vidas--;
            document.getElementById("vidasTxt").innerText = vidas;
            e.alive = false;

            if (vidas <= 0) {
                player.alive = false;
                explode(player.x+40, player.y+40);
                setTimeout(() => alert("GAME OVER!"), 800);
            }
        }
    });

    enemies = enemies.filter(e => e.alive && e.y < canvas.height + 100);

    /* PARTÃCULAS */
    particles.forEach(p => {
        p.x += p.dx;
        p.y += p.dy;
        p.life--;
    });
    particles = particles.filter(p => p.life > 0);
}

/* ============================
   DESENHAR TUDO
============================ */
function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    if (player.alive)
        ctx.drawImage(playerImg, player.x, player.y, player.width, player.height);

    bullets.forEach(b => {
        ctx.fillStyle = "yellow";
        ctx.fillRect(b.x, b.y, b.width, b.height);
    });

    enemies.forEach(e => {
        ctx.drawImage(enemyImg, e.x, e.y, e.width, e.height);
    });

    particles.forEach(p => {
        ctx.fillStyle = "orange";
        ctx.fillRect(p.x, p.y, 4, 4);
    });
}

/* ============================
   LOOP PRINCIPAL
============================ */
function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
